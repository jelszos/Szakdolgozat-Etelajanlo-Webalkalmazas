import{g as V,i as x,G as O,B as E,r as F,o as j,_ as D,j as _,t as m,F as U,v as A,k as a,l as N,m as v,s as t,y as i,q as p,D as w,I as T,d as M,C as H,u as z,f as G,E as B}from"./app-9yHSs_0k.js";import{R as q}from"./recipe-book.service-D-CAdHjl.js";import{u as L}from"./date-format-GlMVmkoP.js";import{f as J}from"./functions-BhiSqBls.js";import{R as K}from"./recipe-book-relation.service-B02sJgJu.js";const Q={name:"RecipeBookRecipeCard",components:{FontAwesomeIcon:V},props:{recipes:{type:Array,required:!0},deleteFromRecipeBook:{type:Function}},setup(){const o=x("recipeBookService",()=>new q),s=O(),d=E(),l=F(!1);return j(async()=>{var u;try{const r=await o().getOwner((u=d.params)==null?void 0:u.recipeBookId);console.log("res here",r),l.value=r===s.account.login}catch(r){console.error("Error fetching ownership status:",r),l.value=!1}}),console.log(l.value),console.log(s.account.login),{store:s,route:d,isOwnedByUser:l}},computed:{functions(){return J}},methods:{formatFoodCategory(o){return o?o.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()):""}}},W={class:"recipe-book-recipes"},X={class:"d-flex justify-content-between"},Y={key:0,class:"card-icon bg-warning rtime-badge text-center",style:{"background-color":"yellow",color:"black"}},Z={key:1,class:"bg-white-glass d-flex align-items-center",style:{padding:"0 8px","border-radius":"16px"}},ee={key:2,class:"d-flex gap-custom"},te=["onClick"],oe={class:"d-flex justify-content-between",style:{height:"90%"}},se={class:"d-flex image-bottom-badge"},ne={class:"bg-yellow-glass rtime-badge px-1"},ce={class:"text-slate-900"},re={class:"bg-primary-glass rtime-badge"},ae={class:"text-left"},ie={class:"truncate text-slate-900 text-truncate-line-1",style:{"font-size":"18px"}},le={class:"truncate text-slate-900 text-truncate-line-2",style:{"font-weight":"500","line-height":"1.3"}};function de(o,s,d,l,f,u){const r=_("font-awesome-icon"),g=_("b-card");return a(),m("div",W,[(a(!0),m(U,null,A(d.recipes,e=>(a(),N(g,{key:e,"img-src":e==null?void 0:e.imageUrl,"img-alt":"Image",class:"custom-card","img-top":"",style:{color:"#212529"},tag:"a",href:`/recipe/${e.id}/view`,overlay:""},{footer:v(()=>[t("div",ae,[t("p",ie,i(e.title),1),t("p",le,i(e.description),1)])]),default:v(()=>[t("div",X,[e!=null&&e.requiredTime?(a(),m("div",Y,[p(r,{icon:"clock",style:{color:"black"}}),t("span",null,i(e.requiredTimeSum)+" mins",1)])):w("",!0),e!=null&&e.totalRating?(a(),m("div",Z,[p(r,{icon:"heart",style:{color:"#e30000"}}),t("span",null,i(e==null?void 0:e.favoriteCount),1)])):w("",!0),d.deleteFromRecipeBook?(a(),m("div",ee,[d.deleteFromRecipeBook?(a(),m("div",{key:0,class:"p-1 bg-danger favorite-badge",onClick:T(h=>d.deleteFromRecipeBook(e.id),["stop","prevent"])},[p(r,{icon:"close",style:{color:"rgb(239, 239, 239)"}})],8,te)):w("",!0)])):w("",!0)]),t("div",oe,[t("div",se,[t("div",ne,[t("span",ce,i(u.formatFoodCategory(e==null?void 0:e.foodCategory)),1)]),t("div",re,[t("span",null,i(e==null?void 0:e.foodType),1)])])])]),_:2},1032,["img-src","href"]))),128))])}const ue=D(Q,[["render",de],["__scopeId","data-v-db704126"]]),pe=M({compatConfig:{MODE:3},name:"RecipeBookDetails",components:{RecipeBookRecipeCard:ue},setup(){var I;const o=L(),s=x("recipeBookService",()=>new q),d=x("recipeRelationService",()=>new K),l=x("alertService",()=>G(),!0),f=O(),u=E(),r=H(),g=()=>r.go(-1),e=F({}),h=F([]),R=async c=>{try{const n=await s().find(c);e.value=n}catch(n){l.showHttpError(n.response)}},S=async c=>{try{const n=await d().getAllByRecipeId(c);h.value=n.data}catch(n){l.showHttpError(n.response)}};(I=u.params)!=null&&I.recipeBookId&&(R(u.params.recipeBookId),S(u.params.recipeBookId));function $(c){var n;d().deleteByRecipeNBookId(c,(n=u.params)==null?void 0:n.recipeBookId).then(b=>{b.status===204&&(h.value=h.value.filter(C=>C.id!==c),l.showSuccess("Successfully deleted recipe from your recipe book!"))}).catch(b=>{var C;l.showError((C=b==null?void 0:b.response)==null?void 0:C.data)})}function k(){var c,n;return((c=f==null?void 0:f.account)==null?void 0:c.id)==((n=e.value.user)==null?void 0:n.id)}const y=F(!1);j(async()=>{var c;try{const n=await s().getOwner((c=u.params)==null?void 0:c.recipeBookId);console.log("res here",n),y.value=n===f.account.login}catch(n){console.error("Error fetching ownership status:",n),y.value=!1}});function P(){s().toggleRecipeBookStatus(e.value.id).then(c=>{console.log("res here",c)}),e.value.isPrivate=!e.value.isPrivate}return{...o,alertService:l,recipeBook:e,recipes:h,deleteFromRecipeBook:$,isOwnedByUser:y,changeRBStatus:P,ownByUser:k,previousState:g,t$:z().t}},methods:{}}),me={class:"row justify-content-center"},_e={class:"container"},fe={class:"d-flex justify-content-between"},he=["textContent"],ke={class:"d-flex align-items-center"},ve={class:"mr-2"},ge=["onClick"],ye=["textContent"],be={class:"d-flex justify-content-between align-items-center mt-4"},Be={class:"container my-4"},we={class:"row justify-content-center"},Re={key:0},Se={key:1};function $e(o,s,d,l,f,u){var $;const r=_("font-awesome-icon"),g=_("b-form-checkbox"),e=_("router-link"),h=_("b-tooltip"),R=_("b-badge"),S=_("recipe-book-recipe-card");return a(),m("div",me,[t("div",_e,[t("div",fe,[t("button",{type:"submit",onClick:s[0]||(s[0]=T(k=>o.previousState(),["prevent"])),class:"btn btn-info","data-cy":"entityDetailsBackButton"},[p(r,{icon:"arrow-left"}),s[1]||(s[1]=B(" ")),t("span",{textContent:i(o.t$("entity.action.back"))},null,8,he)]),o.ownByUser()?(a(),N(e,{key:0,to:{name:"RecipeBookEdit",params:{recipeBookId:o.recipeBook.id}},custom:""},{default:v(({navigate:k})=>[t("div",ke,[t("span",ve,i(o.recipeBook.isPrivate?"Recipe book is private":"Recipe book is public"),1),p(g,{class:"mr-4",switch:"",checked:o.recipeBook.isPrivate,onchange:o.changeRBStatus},null,8,["checked","onchange"]),t("button",{onClick:k,class:"btn btn-primary"},[p(r,{icon:"pencil-alt"}),s[2]||(s[2]=B(" ")),t("span",{textContent:i(o.t$("entity.action.edit"))},null,8,ye)],8,ge)])]),_:1},8,["to"])):w("",!0)]),t("div",be,[t("h1",null,i(o.recipeBook.title),1),t("div",null,[p(h,{target:"1"},{default:v(()=>s[3]||(s[3]=[B("Theme")])),_:1}),p(R,{id:"1"},{default:v(()=>[B(i(o.recipeBook.theme),1)]),_:1})])]),t("div",null,[t("div",null,i(o.recipeBook.description),1),t("div",Be,[t("div",we,[t("div",null,[(a(!0),m(U,null,A(($=o.recipeBook.tags)==null?void 0:$.split(","),(k,y)=>(a(),m("span",{key:y},[p(R,{variant:"primary",class:"hashtag-badge"},{default:v(()=>[B("#"+i(k),1)]),_:2},1024)]))),128))])])]),o.isOwnedByUser?(a(),m("div",Re,[p(S,{recipes:o.recipes,"delete-from-recipe-book":o.deleteFromRecipeBook},null,8,["recipes","delete-from-recipe-book"])])):(a(),m("div",Se,[p(S,{recipes:o.recipes},null,8,["recipes"])]))])])])}const je=D(pe,[["render",$e],["__scopeId","data-v-8d8ca26c"]]);export{je as default};
