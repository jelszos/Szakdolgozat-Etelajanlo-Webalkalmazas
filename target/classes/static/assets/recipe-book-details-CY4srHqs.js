import{g as P,i as x,G as O,B as E,r as F,o as j,_ as A,j as _,t as m,F as D,v as U,k as c,l as z,m as g,s as t,y as i,q as p,D as w,I as N,d as V,C as M,u as H,f as G,E as b}from"./app-DpqgLFQi.js";import{R as T}from"./recipe-book.service-Df3-flx1.js";import{u as L}from"./date-format-rfZit4qg.js";import{f as J}from"./functions-BsjzqxxS.js";import{R as K}from"./recipe-book-relation.service-TGUZApoV.js";const Q={name:"RecipeBookRecipeCard",components:{FontAwesomeIcon:P},props:{recipes:{type:Array,required:!0},deleteFromRecipeBook:{type:Function}},setup(){const o=x("recipeBookService",()=>new T),s=O(),d=E(),l=F(!1);return j(async()=>{var u;try{const r=await o().getOwner((u=d.params)==null?void 0:u.recipeBookId);console.log("res here",r),l.value=r===s.account.login}catch(r){console.error("Error fetching ownership status:",r),l.value=!1}}),console.log(l.value),console.log(s.account.login),{store:s,route:d,isOwnedByUser:l}},computed:{functions(){return J}},methods:{formatFoodCategory(o){return o?o.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()):""}}},W={class:"recipe-book-recipes"},X={class:"d-flex justify-content-between"},Y={key:0,class:"card-icon bg-warning rtime-badge text-center",style:{"background-color":"yellow",color:"black"}},Z={key:1,class:"bg-white-glass d-flex align-items-center",style:{padding:"0 8px","border-radius":"16px"}},ee={key:2,class:"d-flex gap-custom"},te=["onClick"],oe={class:"d-flex justify-content-between",style:{height:"90%"}},se={class:"d-flex image-bottom-badge"},ne={class:"bg-yellow-glass rtime-badge px-1"},ae={class:"text-slate-900"},re={class:"bg-primary-glass rtime-badge"},ce={class:"text-left"},ie={class:"truncate text-slate-900 text-truncate-line-1",style:{"font-size":"18px"}},le={class:"truncate text-slate-900 text-truncate-line-2",style:{"font-weight":"500","line-height":"1.3"}};function de(o,s,d,l,f,u){const r=_("font-awesome-icon"),v=_("b-card");return c(),m("div",W,[(c(!0),m(D,null,U(d.recipes,e=>(c(),z(v,{key:e,"img-src":e==null?void 0:e.imageUrl,"img-alt":"Image",class:"custom-card","img-top":"",style:{color:"#212529"},tag:"a",href:`/recipe/${e.id}/view`,overlay:""},{footer:g(()=>[t("div",ce,[t("p",ie,i(e.title),1),t("p",le,i(e.description),1)])]),default:g(()=>[t("div",X,[e!=null&&e.requiredTime?(c(),m("div",Y,[p(r,{icon:"clock",style:{color:"black"}}),t("span",null,i(e.requiredTimeSum)+" mins",1)])):w("",!0),e!=null&&e.totalRating?(c(),m("div",Z,[p(r,{icon:"heart",style:{color:"#e30000"}}),t("span",null,i(e==null?void 0:e.favoriteCount),1)])):w("",!0),d.deleteFromRecipeBook?(c(),m("div",ee,[d.deleteFromRecipeBook?(c(),m("div",{key:0,class:"p-1 bg-danger favorite-badge",onClick:N(k=>d.deleteFromRecipeBook(e.id),["stop","prevent"])},[p(r,{icon:"close",style:{color:"rgb(239, 239, 239)"}})],8,te)):w("",!0)])):w("",!0)]),t("div",oe,[t("div",se,[t("div",ne,[t("span",ae,i(u.formatFoodCategory(e==null?void 0:e.foodCategory)),1)]),t("div",re,[t("span",null,i(e==null?void 0:e.foodType),1)])])])]),_:2},1032,["img-src","href"]))),128))])}const ue=A(Q,[["render",de],["__scopeId","data-v-db704126"]]),pe=V({compatConfig:{MODE:3},name:"RecipeBookDetails",components:{RecipeBookRecipeCard:ue},setup(){var I;const o=L(),s=x("recipeBookService",()=>new T),d=x("recipeRelationService",()=>new K),l=x("alertService",()=>G(),!0),f=O(),u=E(),r=M(),v=()=>r.go(-1),e=F({}),k=F([]),R=async a=>{try{const n=await s().find(a);e.value=n}catch(n){l.showHttpError(n.response)}},S=async a=>{try{const n=await d().getAllByRecipeId(a);k.value=n.data}catch(n){l.showHttpError(n.response)}};(I=u.params)!=null&&I.recipeBookId&&(R(u.params.recipeBookId),S(u.params.recipeBookId));function $(a){var n;d().deleteByRecipeNBookId(a,(n=u.params)==null?void 0:n.recipeBookId).then(B=>{B.status===204&&(k.value=k.value.filter(C=>C.id!==a),l.showSuccess("Successfully deleted recipe from your recipe book!"))}).catch(B=>{var C;l.showError((C=B==null?void 0:B.response)==null?void 0:C.data)})}function h(){var a,n;return((a=f==null?void 0:f.account)==null?void 0:a.id)==((n=e.value.user)==null?void 0:n.id)}const y=F(!1);j(async()=>{var a;try{const n=await s().getOwner((a=u.params)==null?void 0:a.recipeBookId);console.log("res here",n),y.value=n===f.account.login}catch(n){console.error("Error fetching ownership status:",n),y.value=!1}});function q(){s().toggleRecipeBookStatus(e.value.id).then(a=>{console.log("res here",a)}),e.value.isPrivate=!e.value.isPrivate}return{...o,alertService:l,recipeBook:e,recipes:k,deleteFromRecipeBook:$,isOwnedByUser:y,changeRBStatus:q,ownByUser:h,previousState:v,t$:H().t}},methods:{}}),me={class:"row justify-content-center"},_e={class:"container"},fe={class:"d-flex justify-content-between"},ke=["textContent"],he={class:"d-flex align-items-center"},ge={class:"mr-2"},ve=["onClick"],ye=["textContent"],Be={class:"d-flex justify-content-between align-items-center mt-4"},be={class:"container my-4"},we={class:"row justify-content-center"},Re={key:0},Se={key:1};function $e(o,s,d,l,f,u){var $;const r=_("font-awesome-icon"),v=_("b-form-checkbox"),e=_("router-link"),k=_("b-tooltip"),R=_("b-badge"),S=_("recipe-book-recipe-card");return c(),m("div",me,[t("div",_e,[t("div",fe,[t("button",{type:"submit",onClick:s[0]||(s[0]=N(h=>o.previousState(),["prevent"])),class:"btn btn-info","data-cy":"entityDetailsBackButton"},[p(r,{icon:"arrow-left"}),s[1]||(s[1]=b(" ")),t("span",{textContent:i(o.t$("entity.action.back"))},null,8,ke)]),o.ownByUser()?(c(),z(e,{key:0,to:{name:"RecipeBookEdit",params:{recipeBookId:o.recipeBook.id}},custom:""},{default:g(({navigate:h})=>[t("div",he,[t("span",ge,i(o.t$(o.recipeBook.isPrivate?"szakdolgozatApp.recipeBook.mypage.private":"szakdolgozatApp.recipeBook.mypage.public")),1),p(v,{class:"mr-4",switch:"",checked:o.recipeBook.isPrivate,onchange:o.changeRBStatus},null,8,["checked","onchange"]),t("button",{onClick:h,class:"btn btn-primary"},[p(r,{icon:"pencil-alt"}),s[2]||(s[2]=b(" ")),t("span",{textContent:i(o.t$("entity.action.edit"))},null,8,ye)],8,ve)])]),_:1},8,["to"])):w("",!0)]),t("div",Be,[t("h1",null,i(o.recipeBook.title),1),t("div",null,[p(k,{target:"1"},{default:g(()=>s[3]||(s[3]=[b("Theme")])),_:1}),p(R,{id:"1"},{default:g(()=>[b(i(o.recipeBook.theme),1)]),_:1})])]),t("div",null,[t("div",null,i(o.recipeBook.description),1),t("div",be,[t("div",we,[t("div",null,[(c(!0),m(D,null,U(($=o.recipeBook.tags)==null?void 0:$.split(","),(h,y)=>(c(),m("span",{key:y},[p(R,{variant:"primary",class:"hashtag-badge"},{default:g(()=>[b("#"+i(h),1)]),_:2},1024)]))),128))])])]),o.isOwnedByUser?(c(),m("div",Re,[p(S,{recipes:o.recipes,"delete-from-recipe-book":o.deleteFromRecipeBook},null,8,["recipes","delete-from-recipe-book"])])):(c(),m("div",Se,[p(S,{recipes:o.recipes},null,8,["recipes"])]))])])])}const je=A(pe,[["render",$e],["__scopeId","data-v-a006bdd4"]]);export{je as default};
